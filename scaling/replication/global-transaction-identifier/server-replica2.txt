# ip: 167.99.81.228
# host: database3

-- we assume third server join along way after current replication running (scaling up)
-- and large data exist on current source-replica1 servers
-- continue steps from server-source (1)

$> mysqladmin -uroot -p shutdown

## Setting replication configuration
mysql> SET GLOBAL server_id = 3;
mysql> SET GLOBAL gtid_mode = ON;
mysql> SET GLOBAL enforce-gtid-consistency = ON;
mysql> SET GLOBAL skip_replica_start = OFF;

or in my.cnf file to survive when mysql shutdown/restart:

-- https://dev.mysql.com/doc/refman/8.0/en/replication-gtids-failover.html
-- Copying data and transactions to the replica: either Data Set or Transaction History
-- sometimes we need to reset the replica
-- RESET REPLICA makes the replica forget its position in the source's binary log.

$> service mysql start

mysql> CHANGE REPLICATION SOURCE TO
    ->     SOURCE_HOST='157.245.196.139',
    ->     SOURCE_PORT = 3306,
    ->     SOURCE_USER='repl',
    ->     SOURCE_PASSWORD='password',
    ->     SOURCE_AUTO_POSITION=1;

mysql> START REPLICA;

## REPLICATION RULES (FILTER REPLICA)
-- should stop replica sql thread
mysql> STOP REPLICA SQL_THREAD FOR CHANNEL '';
mysql> CHANGE REPLICATION FILTER
    ->      REPLICATE_DO_DB = (ecommerce, purchasing);
    ->      REPLICATE_IGNORE_DB = (system_logs, sandbox);
    ->      REPLICATE_DO_TABLE = (ecommerce.users, ecommerce.products, purchasing.vendors);
    ->      REPLICATE_IGNORE_TABLE = (ecommerce.logs, purchasing.logs);
    ->      REPLICATE_WILD_DO_TABLE = (wild_tbl_list);
    ->      REPLICATE_WILD_IGNORE_TABLE = (wild_tbl_list);
    ->      REPLICATE_REWRITE_DB = ((ecommerce, e_commerce_v1));
    ->      FOR CHANNEL '';
mysql> START REPLICA SQL_THREAD FOR CHANNEL '';